import { ArgsTable, Canvas, Description, IconGallery, IconItem, Meta, Story } from "@storybook/addon-docs";
import { ComponentTokensTable } from "../../documentation/components/ComponentTokensTable";
import tokens from "../../proprietary/design-tokens/dist/index.json";
import contributing from "./CONTRIBUTING.md";
import readme from "./README.md";
import design from "./design.md";
import iconSet from "./icon-set.json";

export const IconExample = ({ color, icon, size }) => `<button type="button" style="
  --utrecht-icon-color: ${color};
  --utrecht-icon-size: ${size}px;
  align-items: center;
  background-color: transparent;
  border: 1px solid silver;
  display: flex;
  gap: 10px;
  padding-inline: 10px;
">
  <${icon}></${icon}>
  Search
</button>`;

export const removeMarkdownH1 = (markdown) => markdown.replace(/(^|\n)#\s.+/, "");

<!--
 * Convert `# First heading` to `## First heading` with an adjustment of +1
 * Convert `## Another heading` to `# Another heading` with an adjustment of -1
 * Since no Markdown parsing, this function can have unintended side effects
 * such as adjusting headings inside Markdown code blocks.
-->

export const adjustHeadingLevel = (markdown = "", adjustment = 0) =>
  markdown.replace(/(^|\n)(#+)/g, (_, lineFeed, headingPrefix) => {
    return `${lineFeed}${"#".repeat(headingPrefix.length + adjustment)}`;
  });

<Meta
  title="Utrecht/Icons"
  argTypes={{
    color: {
      description: "Color of the icon",
      control: "color",
    },
    icon: {
      description: "Icon",
      control: { type: "select" },
      options: [...iconSet],
    },
    size: {
      description: "Size of the icon (in pixels)",
      control: "number",
    },
  }}
  parameters={{
    docs: {
      transformSource: (_src, { args }) => IconExample(args),
    },
    status: {
      type: "WORK IN PROGRESS",
    },
  }}
/>

# Icons

<Description>{design}</Description>

<Canvas>
  <Story
    name="Icons"
    args={{
      color: "#888888",
      icon: "utrecht-icon-instagram",
      size: 32,
    }}
    parameters={{
      percy: false,
    }}
  >
    {IconExample.bind({})}
  </Story>
</Canvas>

<ArgsTable story="Icons" />

## Social Media

<IconGallery>
  <IconItem name="Facebook">
    <utrecht-icon-facebook></utrecht-icon-facebook>
  </IconItem>
  <IconItem name="Instagram">
    <utrecht-icon-instagram></utrecht-icon-instagram>
  </IconItem>
  <IconItem name="Twitter">
    <utrecht-icon-twitter></utrecht-icon-twitter>
  </IconItem>
  <IconItem name="Linkedin">
    <utrecht-icon-linkedin></utrecht-icon-linkedin>
  </IconItem>
  <IconItem name="WhatsApp">
    <utrecht-icon-whatsapp></utrecht-icon-whatsapp>
  </IconItem>
</IconGallery>

## Functional

<IconGallery>
  <IconItem name="Arrow">
    <utrecht-icon-arrow></utrecht-icon-arrow>
  </IconItem>
  <IconItem name="Checkmark">
    <utrecht-icon-checkmark></utrecht-icon-checkmark>
  </IconItem>
  <IconItem name="Cross">
    <utrecht-icon-cross></utrecht-icon-cross>
  </IconItem>
  <IconItem name="Loupe">
    <utrecht-icon-loupe></utrecht-icon-loupe>
  </IconItem>
</IconGallery>

## Feedback

<IconGallery>
  <IconItem name="warning">
    <utrecht-icon-warning></utrecht-icon-warning>
  </IconItem>
  <IconItem name="error">
    <utrecht-icon-error></utrecht-icon-error>
  </IconItem>
  <IconItem name="information">
    <utrecht-icon-information></utrecht-icon-information>
  </IconItem>
</IconGallery>

## Map Contol

<IconGallery>
  <IconItem name="Filter">
    <utrecht-icon-filter></utrecht-icon-filter>
  </IconItem>
  <IconItem name="List">
    <utrecht-icon-list></utrecht-icon-list>
  </IconItem>
  <IconItem name="Zoomin">
    <utrecht-icon-zoomin></utrecht-icon-zoomin>
  </IconItem>
  <IconItem name="Zoomout">
    <utrecht-icon-zoomout></utrecht-icon-zoomout>
  </IconItem>
</IconGallery>

<Description>{removeMarkdownH1(readme)}</Description>

## Design Tokens

<ComponentTokensTable tokens={tokens} component="utrecht-icon"></ComponentTokensTable>

<Description>{adjustHeadingLevel(contributing, 1)}</Description>
